package geteway.SecurityLessonPentest.HtmlInjection;


import org.owasp.html.HtmlPolicyBuilder;
import org.owasp.html.PolicyFactory;
import org.springframework.http.MediaType;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/restricted")
public class HtmlInjectionController {

	private final PolicyFactory policy = new HtmlPolicyBuilder()
			.allowElements("b", "i", "u")
			.toFactory();
	@GetMapping(value = "/injection")
	public String data(@RequestParam(name = "test")String name){
		String safe = policy.sanitize(name);

		return safe;
	}

}
